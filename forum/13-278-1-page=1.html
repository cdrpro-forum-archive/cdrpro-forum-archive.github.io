<!doctype html>
<html lang="ru">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/all/themes/cdrpro2/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="shortlink" href="../node/591.html" />
<link rel="canonical" href="13-278-1.html" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
    <title>Проблема с макросом ExImPhotoshop | CDRPRO.RU - сообщество CorelDRAW</title>




<style type="text/css" media="all">@import url("../sites/all/libraries/syntaxhighlighter_3.0.83/styles/shCore-nzf3o4.css");
@import url("../sites/all/libraries/syntaxhighlighter_3.0.83/styles/shThemeDefault-nzf3o4.css");
</style>
<style type="text/css" media="all">@import url("../sites/all/themes/cdrpro2/styles-nzf3o4.css");
</style>
</head>
<body>
<div id="content" class="page-content">
    <h1 id="page-title">Проблема с макросом ExImPhotoshop</h1>      <div class="region region-content">
    <div id="block-system-main" class="block block-system">

    
  <div class="content">
    <div id="node-591" class="node node-forum clearfix">

	<div class="submitted">
		<strong><span class="username">Zigzain</span></strong> / 15.02.2010, 15:05/00:41	</div>


	<div class="content">
	<div class="field field-name-taxonomy-forums field-type-taxonomy-term-reference field-label-inline clearfix"><div class="field-label">Форум:&nbsp;</div><div class="field-items"><div class="field-item even"><a href="../macros-forum.html">Макросы и скрипты</a></div></div></div><div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even"><p>Проблема с макросом ExImPhotoshop. Макрос работал исправно где-то несколько месяцев. Сейчас появился глюк-прозрачные изображения импортируются в фотошоп на сером фоне! Версия фотошопа- CS3 ничего не делал ни с корелом ни с фотошопом. Обновления не ставил, строки макроса не переписывал. Помогите исправить проблему!</p>
</div></div></div>    	</div>

	
	<div id="comments" class="comment-wrapper">
  <a id="comment-5214"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">a922</span></strong> / 17.03.2011, 01:45    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><blockquote><p>это скорей связано с Win7</p></blockquote>
<p> Скорее всего, но как решить проблему? На ХР все работало, а теперь на W7 х86 и х64 Ps-CS5 "Error in loading DLL и все (((" . Присоединяюсь к крикам о помощи.</p>
</div></div></div>	</div>
</div>
<a id="comment-5215"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">RedSun</span></strong> / 12.04.2011, 15:37    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Использую Corel X5 в связке с Photoshop CS5 на Windows7 x64. Плагин работает, конечно доработал его как указывалось раньше. строку VBA.AppActivate (obj.Name) заменить на 'VBA.AppActivate (obj.Name) Вызывает сам плагин фотошоп, правлю растр, обязательно сохраняю правленый растр в фотошопе, и можно его закрывать. Но в кореле обязательно картинку приходится выбирать вновь, и после завершать обновление правленого изображения кликнув на иконку UpdateAfterEditInPhotoShop</p>
</div></div></div>	</div>
</div>
<a id="comment-5216"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">navan</span></strong> / 09.06.2011, 21:58    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>День добрый! <br /> Никак не могу подружить макрос на новом компьютере. <br /> Win 7 x64 Rus, Corel x5 Rus 15.2.0.686, CS5 Design Standard. <br /> В составе пакета установлен Photoshop x32 и x64, но ошибка Error in loading DLL присутствует. <br /> Пытался найти вручную Adobe Photoshop №версии Object Library x32 версии, чтобы подставить в Corel, но так и не нашел. <br /> Помогите.... <br /> p.s. Думал удалить x64 photoshop из пакета, но он удаляется вместе с x32. <br /> Устанавливал не я, поэтому не могу сказать возможно ли установить отдельно x32 photoshop без х64</p>
</div></div></div>	</div>
</div>
<a id="comment-5217"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">Sancho</span></strong> / 09.06.2011, 22:57    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><div class="CDRadmAlert"><b>navan</b>, неделя отдыха за нарушение правил п. III.3</div>
</div></div></div>	</div>
</div>
<a id="comment-7139"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">andy</span></strong> / 21.09.2011, 17:33/17:36    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>проблема с этим макросом на х3(32bit) на win7(64 bit), после нажатия "edit..."<br />
показывает "5 invalid procedure call or argument",<br />
но когда нажимаю ок, то image все таки открывается в фотошопе, но окно фотошопа не становится активным.<br />
есть возможность отключить показ этой ошибки или пофиксить?</p>
</div></div></div>
<div class="dd-attached field field-name-field-forum-images field-type-image field-label-above clearfix">
      <div class="field-label"><a href="13-278-1-page=1.html#" class="cdrSlideAttach">Изображения</a></div>
    <div class="field-items clearfix">
          <div class="field-item">
				<a href="../sites/default/files/forum/images/untitled-1_1.jpg" target="_blank" class="colorbox"><img src="../sites/default/files/styles/40x40/public/forum/images/untitled-1_1-itok=-NzVmIF5.jpg" alt="" title="" /></a>      </div>
      </div>
</div>
	</div>
</div>
<a id="comment-7421"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">Koolk</span></strong> / 28.10.2011, 15:33    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Привет. Error in loading DLL лечится так: UAC снижается до минимального, подключаете библиотеки, возвращаете UAC (рекомендую, хотя самого иногда бесит)</p>
</div></div></div>	</div>
</div>
<a id="comment-7422"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">Koolk</span></strong> / 28.10.2011, 15:36    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>иногда требуется перезагрузка</p>
</div></div></div>	</div>
</div>
<a id="comment-7423"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">Sancho</span></strong> / 28.10.2011, 15:41    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p><strong>Koolk</strong>, не нужно плодить посты подряд, есть кнопка редактирования комментария.</p>
</div></div></div>	</div>
</div>
<a id="comment-7424"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">Koolk</span></strong> / 28.10.2011, 16:35/17:00    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Прошу прощенья, описанный мною спопсоб сработал в MS Office, но не работает в Corel.<br />
Вот смотрите, до чего я пока дошел, на данный момент работает кривовато, но может кому пригодится:<br />
1. снижаем UAC<br />
2. из C:\Program Files (x86)\Adobe\Adobe Photoshop CS5\Plug-ins\Extensions все переписываем сюда: C:\Program Files\Adobe\Adobe Photoshop CS5\Plug-ins\Extensions (наверняка можно не все, но пока некогда разбираться, ну родные файлы из этой папки я решил сохранить в сторонке)<br />
3. подключаем требуемую библиотеку, у меня получилось, когда я запусти корел от админского имени<br />
теперь импорт изображения как бы работает, но не до конца, вылетает с ошибкой, пока не разобрался в чем дело, но в папке Temp появляется нужный psd-ник, который оттуда открываем шопом, правим, сохраняем, а макрос обратного экспорта работает без проблем. Кстати, всегда перенаправляю Temp в другое место - c:\Temp и вам рекомендую.</p>
</div></div></div>	</div>
</div>
<a id="comment-7425"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">Koolk</span></strong> / 28.10.2011, 19:01/19:03    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Извините за суету, Не думал, что сегодня руки дотянутся. Но вас порадует, что проблема решена. Итак, делаем макрос независимым от библиотек Photoshopa. Пункт 4 "В меню Tools выбираем пункт References. В открывшемся диалоговом окне, в списке, находим строку Adobe Photoshop №версии Object Library. Ставим напротив неё галочку и нажимаем ОК." из инструкции делать не нужно, если сделан - ничего страшного. вместо этого в процедуре EditInPhotoShop() добовляем два определения переменных:<br />
dim WshScript as Object<br />
dim k as integer<br />
а вместо строчек<br />
obj.Open p<br />
VBA.AppActivate (obj.Name)<br />
пишем<br />
 Set WshScript = CreateObject("WScript.Shell")<br />
  k = WshScript.Run(p, 4, False)<br />
вот и все. можно еще убрать строчку Dim obj As New Photoshop.Application<br />
Если есть вопросы, пишите.<br />
PS будет работать если приложение на .psd файлы по умолчанию Photoshop. и предыдущие мои описания плясок с бубном тоже не нужны.</p>
</div></div></div>	</div>
</div>
<h2 class="element-invisible">Страницы</h2><div class="item-list"><ul class="pager"><li class="pager-first first"><a title="На первую страницу" href="13-278-1.html">« первая</a></li>
<li class="pager-previous"><a title="На предыдущую страницу" href="13-278-1.html">‹ предыдущая</a></li>
<li class="pager-item"><a title="На страницу номер 1" href="13-278-1.html">1</a></li>
<li class="pager-current">2</li>
<li class="pager-item"><a title="На страницу номер 3" href="13-278-1-page=2.html">3</a></li>
<li class="pager-next"><a title="На следующую страницу" href="13-278-1-page=2.html">следующая ›</a></li>
<li class="pager-last last"><a title="На последнюю страницу" href="13-278-1-page=2.html">последняя »</a></li>
</ul></div></div>

</div>
  </div>
</div>
  </div>
</div>
</body>
</html>
