<!doctype html>
<html lang="ru">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/all/themes/cdrpro2/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="shortlink" href="4146.html" />
<link rel="canonical" href="4146.html" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
    <title>Помогите создать несложный макрос | CDRPRO.RU - сообщество CorelDRAW</title>




<style type="text/css" media="all">@import url("../sites/all/libraries/syntaxhighlighter_3.0.83/styles/shCore-nzf3o4.css");
@import url("../sites/all/libraries/syntaxhighlighter_3.0.83/styles/shThemeDefault-nzf3o4.css");
</style>
<style type="text/css" media="all">@import url("../sites/all/themes/cdrpro2/styles-nzf3o4.css");
</style>
</head>
<body>
<div id="content" class="page-content">
    <h1 id="page-title">Помогите создать несложный макрос</h1>      <div class="region region-content">
    <div id="block-system-main" class="block block-system">

    
  <div class="content">
    <div id="node-4146" class="node node-forum clearfix">

	<div class="submitted">
		<strong><span class="username">blizzz</span></strong> / 24.01.2014, 13:29	</div>


	<div class="content">
	<div class="field field-name-taxonomy-forums field-type-taxonomy-term-reference field-label-inline clearfix"><div class="field-label">Форум:&nbsp;</div><div class="field-items"><div class="field-item even"><a href="../macros-forum.html">Макросы и скрипты</a></div></div></div><div class="field field-name-field-program-version field-type-list-text field-label-inline clearfix"><div class="field-label">Версия программы:&nbsp;</div><div class="field-items"><div class="field-item even">14.0.0.701 (sp2)</div></div></div><div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even"><p>Дано: произвольный прямоугольник со сторонами X и Y.<br />
Задача: создать внутри него рамку (обычно красного цвета). Отступ рамки от края Y*0,025 мм. Ширина рамки X*0,025 мм</p>
</div></div></div>
<div class="dd-attached field field-name-field-forum-images field-type-image field-label-above clearfix">
      <div class="field-label"><a href="4146.html#" class="cdrSlideAttach">Изображения</a></div>
    <div class="field-items clearfix">
          <div class="field-item">
				<a href="../sites/default/files/forum/images/ramka.jpg" target="_blank" class="colorbox"><img src="../sites/default/files/styles/40x40/public/forum/images/ramka-itok=-BskMRmp.jpg" alt="Помогите создать несложный макрос" title="Помогите создать несложный макрос" /></a>      </div>
      </div>
</div>
    	</div>

	
	<div id="comments" class="comment-wrapper">
  <a id="comment-12192"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">Sancho</span></strong> / 24.01.2014, 13:46    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Ну и зачем для этого макрос? Можно же сделать через Blend</p>
</div></div></div>	</div>
</div>
<a id="comment-12193"></a>
<div class="comment comment-by-node-author clearfix">
    <div class="submitted">
        <strong><span class="username">blizzz</span></strong> / 24.01.2014, 14:21    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>одним кликом?</p>
</div></div></div>	</div>
</div>
<a id="comment-12194"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">Sancho</span></strong> / 24.01.2014, 14:33    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Ой напутал, контур а не бленд.</p>
<ol><li>Включаешь запись нового макроса</li>
<li>Применяешь контур с нужными настройками</li>
<li>Выключаешь запись макроса</li>
</ol><p>Используешь.</p>
</div></div></div>	</div>
</div>
<a id="comment-12195"></a>
<div class="comment comment-by-node-author clearfix">
    <div class="submitted">
        <strong><span class="username">blizzz</span></strong> / 24.01.2014, 14:54    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Санчо, я бы не обратился за помощью, если бы не попытался сделать что-то сам. С макросом не вышло, так как он запоминает конкретные значения. А нужны значения, зависящие от длины и высоты прямоугольника.</p>
</div></div></div>	</div>
</div>
<a id="comment-12196"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">Sancho</span></strong> / 24.01.2014, 15:04/15:05    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Ну так открой записанный макрос, разберись как он работает, найди нужные значения и подредактируй по типу <em>Shape.SizeWidth * 0.025</em>.  Кстати по умолчанию все значения в макросах рассчитываются в pt, если не указать отличную единицу измерения.</p>
</div></div></div>	</div>
</div>
<a id="comment-12197"></a>
<div class="comment comment-by-node-author clearfix">
    <div class="submitted">
        <strong><span class="username">blizzz</span></strong> / 24.01.2014, 15:15/15:16    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Уже всё это я проделал. И рассчитал, что в pt мое значение будет 0,098425. Но застрял на ContourCreate<br />
PS. Вот мы реально больше времени потратим не препирательства</p>
</div></div></div>	</div>
</div>
<a id="comment-12198"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">Sancho</span></strong> / 24.01.2014, 15:17    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p><strong>blizzz</strong>, можно не рассчитывать а просто указать Units для активного документа. И что там с ContourCreate?</p>
</div></div></div>	</div>
</div>
<a id="comment-12199"></a>
<div class="comment comment-by-node-author clearfix">
    <div class="submitted">
        <strong><span class="username">blizzz</span></strong> / 24.01.2014, 15:26/15:31    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>это выходит при попытке выполнить записанный скрипт при измененном размере прямоугольника<br />
А Units указывать в начале скрипта, там, где объявляются переменные?<br />
Короче, вот:</p>
<pre class="brush: vb">Sub Frame_GOST()
    Dim OrigSelection As ShapeRange
    Set OrigSelection = ActiveSelectionRange
    Dim eff1 As Effect
    Set eff1 = OrigSelection(1).CreateContour(cdrContourInside, 0.11811, 1, cdrDirectFountainFillBlend, CreateCMYKColor(0, 0, 0, 50), CreateFixedColor(cdrPANTONECoated, 362, 33), CreateCMYKColor(0, 0, 0, 100), 0, 0, cdrContourSquareCap, cdrContourCornerMiteredOffsetBevel, 15#)
    eff1.Contour.Offset = 0.082972
    eff1.Contour.ContourGroup.AddToSelection
    ActiveSelection.Separate
    ' Recording of this command is not supported: SplitDualSpotObject
    Dim eff2 As Effect
    Set eff2 = ActiveLayer.Shapes(2).CreateContour(cdrContourInside, 0.143504, 1, cdrDirectFountainFillBlend, CreateCMYKColor(0, 0, 0, 50), CreateFixedColor(cdrPANTONECoated, 362, 33), CreateCMYKColor(0, 0, 0, 100), 0, 0, cdrContourSquareCap, cdrContourCornerMiteredOffsetBevel, 15#)
    ActiveDocument.CreateSelection eff2.Contour.ContourGroup, ActiveLayer.Shapes(2)
    ActiveSelection.Separate
    ' Recording of this command is not supported: SplitDualSpotObject
    ActiveDocument.CreateSelection ActiveShape.Shapes(1).Shapes(2), ActiveShape.Shapes(1).Shapes(1)
    Dim s1 As Shape
    Set s1 = ActiveSelection.Combine
    s1.Fill.UniformColor.CMYKAssign 0, 100, 100, 0
    s1.Outline.SetNoOutline
End Sub</pre><p>и что за действия в 9 и 14 строках?</p>
</div></div></div>
<div class="dd-attached field field-name-field-forum-images field-type-image field-label-above clearfix">
      <div class="field-label"><a href="4146.html#" class="cdrSlideAttach">Изображения</a></div>
    <div class="field-items clearfix">
          <div class="field-item">
				<a href="../sites/default/files/forum/images/sshot_1.jpg" target="_blank" class="colorbox"><img src="../sites/default/files/styles/40x40/public/forum/images/sshot_1-itok=Rwax9mFh.jpg" alt="" title="" /></a>      </div>
          <div class="field-item">
				<a href="../sites/default/files/forum/images/sshot_2.jpg" target="_blank" class="colorbox"><img src="../sites/default/files/styles/40x40/public/forum/images/sshot_2-itok=77BLf1Cw.jpg" alt="" title="" /></a>      </div>
      </div>
</div>
	</div>
</div>
<a id="comment-12200"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">Sancho</span></strong> / 24.01.2014, 15:43/15:46    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Проблема совсем не в ContourCreate, а в том что макрос пытается выделить не существующий объект(ы).<br />
Вместо Shape.Separate лучше использовать Effect.Separate, так как второй возвращает массив объектов, с которым уже дальше и нужно работать.</p>
<p>Units конечно в начало, код же, в отличии от людей, последователен.</p>
</div></div></div>	</div>
</div>
<a id="comment-12201"></a>
<div class="comment comment-by-node-author clearfix">
    <div class="submitted">
        <strong><span class="username">blizzz</span></strong> / 24.01.2014, 15:52/15:54    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>в какой строке команда Shape.Separate ?<br />
Блин, Санчо, я в этмо коде барахтаюсь, как слепой щенок, так еще и ты загадками говоришь. Я так только отдаляюсь от решения проблемы</p>
</div></div></div>	</div>
</div>
<h2 class="element-invisible">Страницы</h2><div class="item-list"><ul class="pager"><li class="pager-current first">1</li>
<li class="pager-item"><a title="На страницу номер 2" href="4146-page=1.html">2</a></li>
<li class="pager-next"><a title="На следующую страницу" href="4146-page=1.html">следующая ›</a></li>
<li class="pager-last last"><a title="На последнюю страницу" href="4146-page=1.html">последняя »</a></li>
</ul></div></div>

</div>
  </div>
</div>
  </div>
</div>
</body>
</html>
