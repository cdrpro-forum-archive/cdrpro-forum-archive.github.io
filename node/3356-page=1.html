<!doctype html>
<html lang="ru">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/all/themes/cdrpro2/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="shortlink" href="3356.html" />
<link rel="canonical" href="3356.html" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
    <title>Нужен макрос. Авто размещение направляющих. | CDRPRO.RU - сообщество CorelDRAW</title>




<style type="text/css" media="all">@import url("../sites/all/libraries/syntaxhighlighter_3.0.83/styles/shCore-nzf3o4.css");
@import url("../sites/all/libraries/syntaxhighlighter_3.0.83/styles/shThemeDefault-nzf3o4.css");
</style>
<style type="text/css" media="all">@import url("../sites/all/themes/cdrpro2/styles-nzf3o4.css");
</style>
</head>
<body>
<div id="content" class="page-content">
    <h1 id="page-title">Нужен макрос. Авто размещение направляющих.</h1>      <div class="region region-content">
    <div id="block-system-main" class="block block-system">

    
  <div class="content">
    <div id="node-3356" class="node node-forum clearfix">

	<div class="submitted">
		<strong><span class="username">Hepatitis C</span></strong> / 17.05.2013, 17:21/17:26	</div>


	<div class="content">
	<div class="field field-name-taxonomy-forums field-type-taxonomy-term-reference field-label-inline clearfix"><div class="field-label">Форум:&nbsp;</div><div class="field-items"><div class="field-item even"><a href="../macros-forum.html">Макросы и скрипты</a></div></div></div><div class="field field-name-field-program-version field-type-list-text field-label-inline clearfix"><div class="field-label">Версия программы:&nbsp;</div><div class="field-items"><div class="field-item even">15.1.0.486/488/489</div></div></div><div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even"><p>Доброго всем дня! Работаю оператором цифровой печати, и есть необходимость в автоматизации процесса установки направляющих. Я руками выставляю направляющие, для подготовки файла к печати. Направляющая на дозаливку (выпуск), до области с важной информацией и между ними - на край листа. По времени, конечно это не долго, макс пару минут, но несколько десятков раз в час. Да на визитки всех размеров, флаеров и то что хотя бы повторяеться раз в день я сделал шаблоны, они мне облегчели жизнь, правда их уже больше 40... Я уже не раз задумывался о одной кнопке или, по крайне мере, меньшем кликанье. Может мне кто нибудь помочь? Возможно похожий или такой уже макрос есть. Буду признателен любому отзову! За ранее спасибо.<br />
Создал не большую анимацию (анимация 1) как я это делаю руками, возможно посмотрев её Вы скажите что макросы так не умеют... Или делайте руками, не трогайте наши голову - я все пойму...<br />
И еще приблизительный интерфейс, мне не сильно важно в точности или такой же, надеюсь рисунок поможет понять, то, что бы я хотел от него. На рисунке (рисунок 1) сделал до 4 направляющих, конечно мне больше 1 от края не надо было, ну если это все возможно, я буду очень благодарен за помощь.</p>
</div></div></div>
<div class="dd-attached field field-name-field-forum-images field-type-image field-label-above clearfix">
      <div class="field-label"><a href="3356-page=1.html#" class="cdrSlideAttach">Изображения</a></div>
    <div class="field-items clearfix">
          <div class="field-item">
				<a href="../sites/default/files/forum/images/1_1.gif" target="_blank" class="colorbox"><img src="../sites/default/files/styles/40x40/public/forum/images/1_1-itok=bQSdkZG_.gif" alt="анимация 1" title="Нужен макрос. Авто размещение направляющих." /></a>      </div>
          <div class="field-item">
				<a href="../sites/default/files/forum/images/2_6.jpg" target="_blank" class="colorbox"><img src="../sites/default/files/styles/40x40/public/forum/images/2_6-itok=kt21LEhu.jpg" alt="рисунок 1" title="Нужен макрос. Авто размещение направляющих." /></a>      </div>
      </div>
</div>
    	</div>

	
	<div id="comments" class="comment-wrapper">
  <a id="comment-11759"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">Sancho</span></strong> / 24.09.2013, 16:59    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><div class="off"><strong>Hepatitis C</strong>, для выделения кода на сайте предусмотрена специальная кнопка. Сообщение поправил.</div>
</div></div></div>	</div>
</div>
<a id="comment-11761"></a>
<div class="comment comment-by-node-author clearfix">
    <div class="submitted">
        <strong><span class="username">Hepatitis C</span></strong> / 24.09.2013, 17:17/17:18    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><div class="off"><strong>Sancho</strong>, подсветка кода?? блин, а я искал такую кнопку, знал, что так и будет...что, кто то напишет про спойлер... но думал будет кнопка КОД а не подсветка.. спс за правку, учту))</div>
</div></div></div>	</div>
</div>
<a id="comment-11765"></a>
<div class="comment comment-by-node-author clearfix">
    <div class="submitted">
        <strong><span class="username">Hepatitis C</span></strong> / 25.09.2013, 15:46    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Уважаемые форумчани, подскажите как адаптировать макрос для 16 корела или почему он не активен?</p>
</div></div></div>	</div>
</div>
<a id="comment-11774"></a>
<div class="comment comment-by-node-author clearfix">
    <div class="submitted">
        <strong><span class="username">Hepatitis C</span></strong> / 27.09.2013, 16:04    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Решено.<br />
Удалил макрос, заново поставил и все хорошо. Значит повредил код.</p>
</div></div></div>	</div>
</div>
<a id="comment-12451"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">hamlo</span></strong> / 04.04.2014, 23:59    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p><strong>Aeliot</strong>, А не подскажете, как в Вашем макросе прописать создание автоматических направляющих по центру документа?</p>
</div></div></div>	</div>
</div>
<a id="comment-12481"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">LiSt</span></strong> / 08.04.2014, 18:58    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p><strong>hamlo</strong>, Я не <strong>Aeliot</strong>, но тоже могу =)<br />
Если совсем по быстрому и по простому (песочница блин, аж стыдно за собственную лень :D)<br />
Зайти в редактор, открыть макрос и в Module-&gt;PutGuidLines добавляем перед End Sub (или в каждый модуль или только в нужный)</p>
<pre class="brush: vb">
    Dim pw#
    Dim ph#
    pw = ActiveDocument.MasterPage.SizeWidth
    ph = ActiveDocument.MasterPage.SizeHeight
    Dim s1 As Shape
    Set s1 = ActiveDocument.MasterPage.GuidesLayer.CreateGuideAngle(pw / 2, 0, 90#)
    Dim s2 As Shape
    Set s2 = ActiveDocument.MasterPage.GuidesLayer.CreateGuideAngle(0, (ph / 2), 0#)
</pre></div></div></div>	</div>
</div>
<a id="comment-12483"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">shark</span></strong> / 09.04.2014, 02:56    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>как вариант, можно не вычислять размер страницы:</p>
<pre class="brush: vb">Dim g As Shape
    Set g = ActiveLayer.CreateGuideAngle(0, 0, 90)
    g.AlignToPageCenter cdrAlignHCenter
    Set g = ActiveLayer.CreateGuideAngle(0, 0, 0)
    g.AlignToPageCenter cdrAlignVCenter</pre></div></div></div>	</div>
</div>
<a id="comment-12487"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">LiSt</span></strong> / 09.04.2014, 16:37    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Кстати, если кому надо сразу при создании страницы добавлять направляющие -<br />
топаем в первую ветку, и в ThisMacroStorage вставляем:</p>
<pre class="brush: vb">
Private Sub GlobalMacroStorage_DocumentNew(ByVal Doc As Document, ByVal FromTemplate As Boolean, ByVal Template As String, ByVal IncludeGraphics As Boolean): AreaArbitrarily: End Sub
</pre><p>И станет он после создания документа выводить окошко с запросом - куда и какие направляющие ставить. Хотя можно сразу пресет использовать, только изменить там varSteps() = Array(X#, X#, X#, X#) на нужные ( с нужным количеством)</p>
</div></div></div>	</div>
</div>
<h2 class="element-invisible">Страницы</h2><div class="item-list"><ul class="pager"><li class="pager-first first"><a title="На первую страницу" href="3356.html">« первая</a></li>
<li class="pager-previous"><a title="На предыдущую страницу" href="3356.html">‹ предыдущая</a></li>
<li class="pager-item"><a title="На страницу номер 1" href="3356.html">1</a></li>
<li class="pager-current last">2</li>
</ul></div></div>

</div>
  </div>
</div>
  </div>
</div>
</body>
</html>
