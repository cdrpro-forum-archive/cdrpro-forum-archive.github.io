<!doctype html>
<html lang="ru">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/all/themes/cdrpro2/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="shortlink" href="3356.html" />
<link rel="canonical" href="3356.html" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
    <title>Нужен макрос. Авто размещение направляющих. | CDRPRO.RU - сообщество CorelDRAW</title>




<style type="text/css" media="all">@import url("../sites/all/libraries/syntaxhighlighter_3.0.83/styles/shCore-nzf3o4.css");
@import url("../sites/all/libraries/syntaxhighlighter_3.0.83/styles/shThemeDefault-nzf3o4.css");
</style>
<style type="text/css" media="all">@import url("../sites/all/themes/cdrpro2/styles-nzf3o4.css");
</style>
</head>
<body>
<div id="content" class="page-content">
    <h1 id="page-title">Нужен макрос. Авто размещение направляющих.</h1>      <div class="region region-content">
    <div id="block-system-main" class="block block-system">

    
  <div class="content">
    <div id="node-3356" class="node node-forum clearfix">

	<div class="submitted">
		<strong><span class="username">Hepatitis C</span></strong> / 17.05.2013, 17:21/17:26	</div>


	<div class="content">
	<div class="field field-name-taxonomy-forums field-type-taxonomy-term-reference field-label-inline clearfix"><div class="field-label">Форум:&nbsp;</div><div class="field-items"><div class="field-item even"><a href="../macros-forum.html">Макросы и скрипты</a></div></div></div><div class="field field-name-field-program-version field-type-list-text field-label-inline clearfix"><div class="field-label">Версия программы:&nbsp;</div><div class="field-items"><div class="field-item even">15.1.0.486/488/489</div></div></div><div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even"><p>Доброго всем дня! Работаю оператором цифровой печати, и есть необходимость в автоматизации процесса установки направляющих. Я руками выставляю направляющие, для подготовки файла к печати. Направляющая на дозаливку (выпуск), до области с важной информацией и между ними - на край листа. По времени, конечно это не долго, макс пару минут, но несколько десятков раз в час. Да на визитки всех размеров, флаеров и то что хотя бы повторяеться раз в день я сделал шаблоны, они мне облегчели жизнь, правда их уже больше 40... Я уже не раз задумывался о одной кнопке или, по крайне мере, меньшем кликанье. Может мне кто нибудь помочь? Возможно похожий или такой уже макрос есть. Буду признателен любому отзову! За ранее спасибо.<br />
Создал не большую анимацию (анимация 1) как я это делаю руками, возможно посмотрев её Вы скажите что макросы так не умеют... Или делайте руками, не трогайте наши голову - я все пойму...<br />
И еще приблизительный интерфейс, мне не сильно важно в точности или такой же, надеюсь рисунок поможет понять, то, что бы я хотел от него. На рисунке (рисунок 1) сделал до 4 направляющих, конечно мне больше 1 от края не надо было, ну если это все возможно, я буду очень благодарен за помощь.</p>
</div></div></div>
<div class="dd-attached field field-name-field-forum-images field-type-image field-label-above clearfix">
      <div class="field-label"><a href="3356.html#" class="cdrSlideAttach">Изображения</a></div>
    <div class="field-items clearfix">
          <div class="field-item">
				<a href="../sites/default/files/forum/images/1_1.gif" target="_blank" class="colorbox"><img src="../sites/default/files/styles/40x40/public/forum/images/1_1-itok=bQSdkZG_.gif" alt="анимация 1" title="Нужен макрос. Авто размещение направляющих." /></a>      </div>
          <div class="field-item">
				<a href="../sites/default/files/forum/images/2_6.jpg" target="_blank" class="colorbox"><img src="../sites/default/files/styles/40x40/public/forum/images/2_6-itok=kt21LEhu.jpg" alt="рисунок 1" title="Нужен макрос. Авто размещение направляющих." /></a>      </div>
      </div>
</div>
    	</div>

	
	<div id="comments" class="comment-wrapper">
  <a id="comment-11316"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">dastin</span></strong> / 17.05.2013, 23:03    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>посмотрите вот это<br /><strong>Макрос Quick Margins</strong><br /><a href="../news/2011-04-04-205.html" target="_blank" title="Макрос Quick Margins (новая версия)">Макрос Quick Margins (новая версия)</a><br />
хотя бы  не руками</p>
</div></div></div>	</div>
</div>
<a id="comment-11317"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">dastin</span></strong> / 17.05.2013, 23:46    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>попробовал<br />
допустим вам нужно создать направляющие с отступом от края 10 мм<br />
- вызвать макрос<br />
- задать единицы мм<br />
- поставить галку - равные значения - Equal GiudeLines<br />
- последовательно ввести в окне<br />
-10 создать - Create GiudeLines<br />
очистить - Clear Value<br />
0 - создать<br />
очистить<br />
10 - создать<br />
при желании в каждом случае дополнительно задавать цвет направляющих,<br />
окно при этом не закрывается, пока вы его сами явно не закроете ...<br />
явно быстрее минуты на все операции</p>
</div></div></div>	</div>
</div>
<a id="comment-11319"></a>
<div class="comment comment-by-node-author clearfix">
    <div class="submitted">
        <strong><span class="username">Hepatitis C</span></strong> / 18.05.2013, 00:57    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>По ссылке очень красиво, думаю это <strong>оно </strong>(то, что мне надо), но смогу проверить только на работе, к сожалению дома компьютера не имею, а в отделении почты нет корел дро. Но заранее огромное спасибо!!!</p>
</div></div></div>	</div>
</div>
<a id="comment-11355"></a>
<div class="comment comment-by-node-author clearfix">
    <div class="submitted">
        <strong><span class="username">Hepatitis C</span></strong> / 23.05.2013, 17:30/17:33    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Не одно так другое, беда на работе с корелом или с бэйсиком...<br />
Открываю Tools-&gt;Macros-&gt;Run macro: и в окне все пусто...</p>
<div class="off">Побывал переустанавливать корел, 11 и 15... видимо что-то с виндой... Если кто нибудь знает напишите...</div>
<p>До сих пор не знаю, подходит этот макрос мне....</p>
</div></div></div>
<div class="dd-attached field field-name-field-forum-images field-type-image field-label-above clearfix">
      <div class="field-label"><a href="3356.html#" class="cdrSlideAttach">Изображения</a></div>
    <div class="field-items clearfix">
          <div class="field-item">
				<a href="../sites/default/files/forum/images/untitled-1_13.jpg" target="_blank" class="colorbox"><img src="../sites/default/files/styles/40x40/public/forum/images/untitled-1_13-itok=RHf6v5t0.jpg" alt="Tools-&gt;Macros-&gt;Run macro" title="" /></a>      </div>
      </div>
</div>
	</div>
</div>
<a id="comment-11426"></a>
<div class="comment comment-by-node-author clearfix">
    <div class="submitted">
        <strong><span class="username">Hepatitis C</span></strong> / 12.06.2013, 19:04    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Значение <strong>s1.SetPosition 0#, 0#</strong> в макросе</p>
<div class="sp-wrap">
<div class="sp-head">Спойлер</div>
<div class="sp-body">
Sub Macros_Napr()<br />
    ' Recorded 12.06.2013<br />
    '<br />
    ' Description:<br />
    '     napravl<br />
    Dim s1 As Shape<br />
    Set s1 = ActiveDocument.MasterPage.GuidesLayer.CreateGuideAngle(0#, 0#, 90#)<br />
    s1.Outline.SetProperties Color:=CreateRGBColor(0, 0, 255)<br />
    ActiveDocument.ReferencePoint = cdrCenter<br />
    s1.SetPosition -3#, 0#<br />
    Dim s2 As Shape<br />
    Set s2 = ActiveDocument.MasterPage.GuidesLayer.CreateGuideAngle(0#, 0#, 90#)<br />
    s2.Outline.SetProperties Color:=CreateRGBColor(0, 0, 255)<br />
    s2.SetPosition 0#, 0#<br />
    Dim s3 As Shape<br />
    Set s3 = ActiveDocument.MasterPage.GuidesLayer.CreateGuideAngle(0#, 0#, 90#)<br />
    s3.Outline.SetProperties Color:=CreateRGBColor(0, 0, 255)<br />
    Windows.FindWindow("Безымянный-1").ActiveView.SetViewPoint 0#, 0#, 200<br />
    s3.SetPosition 3#, 0#<br />
End Sub
</div>
</div>
<p> можно привязать к границе листа? (допустим не -3 inches а -3 inches от края листа правого или левого, не зависимо от размера листа) и можно ли работать не в inches, а в мм?</p>
</div></div></div>	</div>
</div>
<a id="comment-11427"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">Sancho</span></strong> / 12.06.2013, 19:44/15:57    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p><strong>Hepatitis C</strong>, используй менджер объектной модели - F2. Избавит от многих вопросов.<br />
У страницы есть координаты сторон, например ActivePage.LeftX<br />
Единицы измерения ActiveDocument.Unit, можно поставить их как = ActiveDocument.Rulers.HUnits.</p>
<p>П.С, На всякий случай, посмотри в настройки Options &gt; Document &gt; Guidelines &gt; Presets</p>
</div></div></div>	</div>
</div>
<a id="comment-11428"></a>
<div class="comment comment-by-node-author clearfix">
    <div class="submitted">
        <strong><span class="username">Hepatitis C</span></strong> / 13.06.2013, 17:31    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p><strong>Sancho</strong>,в вкладке присэты что-то похожее есть, их можно настроить как то?<br />
скриншот с <em>CorelDRAW x6 16.3.0.1114</em></p>
</div></div></div>
<div class="dd-attached field field-name-field-forum-images field-type-image field-label-above clearfix">
      <div class="field-label"><a href="3356.html#" class="cdrSlideAttach">Изображения</a></div>
    <div class="field-items clearfix">
          <div class="field-item">
				<a href="../sites/default/files/forum/images/444gg6.png" target="_blank" class="colorbox"><img src="../sites/default/files/styles/40x40/public/forum/images/444gg6-itok=8EjXKQvC.png" alt="" title="" /></a>      </div>
      </div>
</div>
	</div>
</div>
<a id="comment-11468"></a>
<div class="comment clearfix">
    <div class="submitted">
        <strong><span class="username">Aeliot</span></strong> / 22.06.2013, 11:16/11:24    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Писал что-то подобное для себя (см. прикрепленный файл). Думаю сообразите как установить GMS-файл.<br />
Расставляет указанные направляющие от края листа (не зависимо от его размера) со всех сторон.<br />
Имеет несколько предустановленных режимов и один произвольный <em>AreaArbitrarily</em> - указываете нужные значения через точку с запитой.<br />
Код открытый, так что при желании можете допилить под свои нужды.<br />
Затем можете вытянуть кнопку на тулбар и все поставит в один клик.</p>
</div></div></div><div class="dd-attached field field-name-field-forum-files field-type-file field-label-above clearfix">
      <div class="field-label"><a href="3356.html#" class="cdrSlideAttach">Файлы</a></div>
    <div class="field-items">
          <div class="field-item even"><span class="file"><img class="file-icon" alt="" title="application/octet-stream" src="/modules/file/icons/application-octet-stream.png" /> <a href="../sites/default/files/forum/files/gruidlines.gms" type="application/octet-stream; length=49170" title="gruidlines.gms">Макрос расстановки направляющих.</a></span></div>
      </div>
</div>
	</div>
</div>
<a id="comment-11480"></a>
<div class="comment comment-by-node-author clearfix">
    <div class="submitted">
        <strong><span class="username">Hepatitis C</span></strong> / 24.06.2013, 16:27    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p><strong> Aeliot</strong>, оооо - это божественный макрос!!! именно для моих потребностей - то, что нужно! огромное спасибо! и код для таких как я, нубов, с коментами открыл и изменил - 5 балов.</p>
</div></div></div>	</div>
</div>
<a id="comment-11758"></a>
<div class="comment comment-by-node-author clearfix">
    <div class="submitted">
        <strong><span class="username">Hepatitis C</span></strong> / 24.09.2013, 16:33/17:00    </div>
	<div class="content">
		<div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>На старой системе и в старом 15 кореле макрос работал а теперь... Скачал, загрузил через диспетчер макросов, выбрал один и нажал изменить, изменил все значение координат в комментариях и в коде на свои (вместо 0 поставил значение -2) и изменил имя. Макрос не хочет запускаться. Выдаёт ошибку. Неактивный в диалоговом окне «запустить макрос». Стандартные макросы работают. Подскажите этот макрос </p>
<blockquote><p>Файлы: Макрос расстановки направляющих. - gruidlines.gms</p></blockquote>
<p>может работать в<br />
CorelDRAW x6 Версия 16.1.0.843<br />
Microsoft Windows XP<br />
Professional<br />
версия 2002<br />
Servis Pack 3<br />
Версия 5.1.2600 Servis pack 3 Сборка 2600</p>
<div class="sp-wrap">
<div class="sp-head">код макроса после изменения</div>
<div class="sp-body">
<pre class="brush: vb">Public Sub border203()
    ' Recorded 30.12.2012
    '
    ' Description:
    '     Макрос расстановки направляющих:
    '     -2 мм, 0 мм, 3 мм - с каждой стороны
    
    Dim dblSteps#()
    Dim intStepCount%
    Dim putGdlns As clsPutGuidLines
    Dim varStep As Variant
    Dim varSteps() As Variant
    
    ' задаем массив направляющий (от края к центру)
    varSteps() = Array(-2#, 0#, 3#)
    
    ' инициируем переменную
    intStepCount = 0
    
    ' обходим строковый массив расстояний и передаем корректные данные
    For Each varStep In varSteps()
        ReDim Preserve dblSteps#(intStepCount)
        dblSteps(intStepCount) = CDbl(varStep)
        intStepCount = intStepCount + 1
    Next varStep
    
    ' получаем экземпляр класса
    Set putGdlns = New clsPutGuidLines
    
    ' расставляем направляющие
    Call putGdlns.PutGuidLinesCommandGroup(dblSteps())
    
    ' удаляем ссылку на экземпляр класса
    Set putGdlns = Nothing
End Sub

Public Sub border203()
    ' Recorded 30.12.2012
    '
    ' Description:
    '     Макрос расстановки направляющих
    '     -2 мм, 0 мм, 3 мм - с каждой стороны
    
    Dim dblSteps#()
    Dim intStepCount%
    Dim putGdlns As clsPutGuidLines
    Dim varStep As Variant
    Dim varSteps() As Variant
    
    ' задаем массив направляющий (от края к центру)
    varSteps() = Array(-2#, 0#, 3#)
    
    ' инициируем переменную
    intStepCount = 0
    
    ' обходим строковый массив расстояний и передаем корректные данные
    For Each varStep In varSteps()
        ReDim Preserve dblSteps#(intStepCount)
        dblSteps(intStepCount) = CDbl(varStep)
        intStepCount = intStepCount + 1
    Next varStep
    
    ' получаем экземпляр класса
    Set putGdlns = New clsPutGuidLines
    
    ' расставляем направляющие
    Call putGdlns.PutGuidLinesCommandGroup(dblSteps())
    
    ' удаляем ссылку на экземпляр класса
    Set putGdlns = Nothing
End Sub

Public Sub AreaSm5()
    ' Recorded 30.12.2012
    '
    ' Description:
    '     Макрос расстановки направляющих
    '     -2 см, 0 см, 3 см - с каждой стороны
    
    Dim dblSteps#()
    Dim intStepCount%
    Dim putGdlns As clsPutGuidLines
    Dim varStep As Variant
    Dim varSteps() As Variant
    
    ' задаем массив направляющий (от края к центру)
    varSteps() = Array(-2#, 0#, 3#)
    
    ' инициируем переменную
    intStepCount = 0
    
    ' обходим строковый массив расстояний и передаем корректные данные
    For Each varStep In varSteps()
        ReDim Preserve dblSteps#(intStepCount)
        dblSteps(intStepCount) = CDbl(varStep)
        intStepCount = intStepCount + 1
    Next varStep
    
    ' получаем экземпляр класса
    Set putGdlns = New clsPutGuidLines
    
    ' расставляем направляющие
    Call putGdlns.PutGuidLinesCommandGroup(dblSteps())
    
    ' удаляем ссылку на экземпляр класса
    Set putGdlns = Nothing
End Sub

Public Sub AreaArbitrarily()
    ' Recorded 30.12.2012
    '
    ' Description:
    '     Макрос расстановки направляющих в произвольном месте
    '     с каждой стороны. Указывать в мм через точку с запятой (;).
    
    Dim dblSteps#()
    Dim intStepCount%
    Dim putGdlns As clsPutGuidLines
    Dim strStepsLine As String
    Dim strSteps() As String
    Dim varStep As Variant
    
    ' задаем запрос
    strStepsLine = InputBox("Укажите расположение направляющих через точку с запятой, " _
                        &amp; "в миллиметрах." &amp; vbCrLf &amp; vbCr _
                        &amp; "Например: -2;0;3" &amp; vbCrLf &amp; vbCr _
                        &amp; "Направляющие будут расставлены со всех сторон страницы." _
                        , "Произвольное расположение направляющих")
    
    ' проверка полученных данных
    If (strStepsLine = "") Then
        MsgBox "Вы ни чего не указали. Выполнение команды не возможно." _
                , vbExclamation, "Произвольное расположение направляющих"
        Exit Sub
    End If
    
    ' инициируем переменную
    intStepCount = 0
    
    ' получаем строковый массив расстояний
    strSteps() = Split(strStepsLine, ";")
    
    ' обходим строковый массив расстояний и передаём корректные данные
    For Each varStep In strSteps()
        If Not IsNull(varStep) Then
            If Not (varStep = "") Then
                ReDim Preserve dblSteps#(intStepCount)
                dblSteps(intStepCount) = CDbl(varStep)
                intStepCount = intStepCount + 1
            End If
        End If
    Next varStep
    
    ' получаем экземпляр класса
    Set putGdlns = New clsPutGuidLines
    
    ' расставляем направляющие
    Call putGdlns.PutGuidLinesCommandGroup(dblSteps())
    
    ' удаляем ссылку на экземпляр класса
    Set putGdlns = Nothing
End Sub</pre></div>
</div>
</div></div></div>
<div class="dd-attached field field-name-field-forum-images field-type-image field-label-above clearfix">
      <div class="field-label"><a href="3356.html#" class="cdrSlideAttach">Изображения</a></div>
    <div class="field-items clearfix">
          <div class="field-item">
				<a href="../sites/default/files/forum/images/bordermacros1.jpg" target="_blank" class="colorbox"><img src="../sites/default/files/styles/40x40/public/forum/images/bordermacros1-itok=6xgwpxNJ.jpg" alt="" title="" /></a>      </div>
          <div class="field-item">
				<a href="../sites/default/files/forum/images/bordermacros2.jpg" target="_blank" class="colorbox"><img src="../sites/default/files/styles/40x40/public/forum/images/bordermacros2-itok=EVmi90Ge.jpg" alt="" title="" /></a>      </div>
      </div>
</div>
	</div>
</div>
<h2 class="element-invisible">Страницы</h2><div class="item-list"><ul class="pager"><li class="pager-current first">1</li>
<li class="pager-item"><a title="На страницу номер 2" href="3356-page=1.html">2</a></li>
<li class="pager-next"><a title="На следующую страницу" href="3356-page=1.html">следующая ›</a></li>
<li class="pager-last last"><a title="На последнюю страницу" href="3356-page=1.html">последняя »</a></li>
</ul></div></div>

</div>
  </div>
</div>
  </div>
</div>
</body>
</html>
